\documentclass[letterpaper,12pt]{article}
\usepackage[section=1.4]{mathhw}
\usepackage{plotting}
\usepackage{siunitx}

% OBLITERATE scientific notation.
\sisetup{
  scientific-notation = fixed,
  fixed-exponent = 0,
  zero-decimal-to-integer,
  round-mode = places,
  round-half = up,
}

\pgfplotstableset{
  sd/.style n args={6}{
    every column/.append style={
      string type,
    },
    columns/rownum/.append style={
      column name={\textbf{#1}},
      column type={S[table-format=#2]},
    },
    columns/0/.append style={
      column name={\boldsymbol{x_i}},
      column type={S[parse-numbers=false]},
    },
    columns/deviation/.append style={
      column name={\boldmath$x_i - \bar{x}$},
      column type={S[table-format=#3, round-precision=#4]},
    },
    columns/devsq/.append style={
      column name={\boldmath$(x_i - \bar{x})^2$},
      column type={S[table-format=#5, round-precision=#6]},
    },
  }
}

\newcommand{\sd}[1]{
  \pgfplotstablesort{#1}{#1}

  \sumcol{0}{#1}{\datasum}
  \pgfplotstablecreatecol[
    expr={
      \datasum / \pgfplotstablerows
    }
  ]{mean}{#1}

  \pgfplotstablecreatecol[
    expr={
      \pgfplotstablerow + 1
    }
  ]{rownum}{#1}

  \pgfplotstablecreatecol[
    expr={
      \thisrowno{0} - \thisrow{mean}
    }
  ]{deviation}{#1}

  \pgfplotstablecreatecol[
    expr={
      pow(\thisrow{deviation}, 2)
    }
  ]{devsq}{#1}

  \pgfplotstablegetrowsof{#1}
    \pgfmathsetmacro{\rowcount}{\pgfplotsretval}

  % \pgfplotstablegetrowsof{#1}
  %   \pgfmathsetmacro{#2}{floor(log10(\pgfplotsretval) + 1)}
}

\newcommand{\subcol}[4]{
  \pgfplotstablenew[
    create on use/#2/.style={
      create col/copy column from table={#1}{#2},
    },
    columns={#2},
  ]{\pgfplotstablegetrowsof{#1}}{#4}
  \pgfplotstablemodifyeachcolumnelement{0}\of{#4}\as\cell{%
    \pgfmathparse{\cell - #3}%
    \edef\cell{\pgfmathresult}%
  }
}

\newcommand{\eval}[1]{
  \pgfmathparse{#1}\num{\pgfmathresult}
}

\newcommand{\evalp}[2]{
  \pgfmathparse{#1}\num[round-precision=#2]{\pgfmathresult}
}

\newcommand{\calcvariance}[1]{
  \sumcol{5}{#1}{\devsq}

  \pgfkeys{/pgf/fpu}
  \pgfmathsetmacro{\variance}{\devsq / (\rowcount - 1)}
  \pgfmathfloattofixed{\variance}
  \pgfkeys{/pgf/fpu=false}
  \pgfmathsetmacro{\variance}{\pgfmathresult}
}

\newcommand{\calcvariancealt}[1]{
  % Do this first before the sum is overwritten.
  \pgfmathsetmacro{\sumsq}{pow(\datasum, 2)}

  \pgfplotstablecreatecol[
    expr={
      pow(\thisrowno{0}, 2)
    }
  ]{sq}{#1}
  \sumcol{6}{#1}{\sumofsq}

  \pgfmathsetmacro{\variance}{(\sumofsq - (\sumsq / \rowcount)) / (\rowcount - 1)}
}

% https://tex.stackexchange.com/a/530325
\newcommand*{\calcmedian}[1]{%
  \ifodd\rowcount\relax
    \pgfplotstablegetelem{\the\numexpr(\rowcount-1)/2}{0}\of{#1}%
    \let\median\pgfplotsretval
  \else
    \pgfplotstablegetelem{\the\numexpr \rowcount/2 - 1}{0}\of{#1}%
    \let\medianl\pgfplotsretval
    \pgfplotstablegetelem{\the\numexpr \rowcount/2}{0}\of{#1}%
    \let\medianr\pgfplotsretval
    \pgfmathsetmacro{\median}{0.5 * (\medianl + \medianr)}%
  \fi
}

\newcommand{\eqmean}[1]{
  \bar{x} &= \frac{\sum{x_i}}{n} = \frac{\num[round-precision=#1]{\datasum}}{\rowcount} = \evalp{\datasum / \rowcount}{#1}
}

\newcommand{\eqmedianodd}{
  \tilde{x} &= x_{\frac{n + 1}{2}} = \median
}

\newcommand{\eqmedianeven}[1]{
  \tilde{x} &= \frac{x_{\frac{n}{2}} + x_{\frac{n}{2} + 1}}{2} = \frac{\medianl + \medianr}{2} \approx \num[round-precision=#1]{\median}
}

\newcommand{\eqvariance}[1]{
  s^2 &= \frac{\sum(x_i - \bar{x})^2}{n - 1} \approx \frac{\num[round-precision=#1]{\devsq}}{\eval{\rowcount - 1}} \approx \num[round-precision=#1]{\variance}
}

\newcommand{\eqvariancealt}[1]{
  s^2 &= \frac{\sum {x_i}^2 - \frac{(\sum x_i)^2}{n}}{n - 1} \approx \frac{\num[round-precision=#1]{\sumofsq} - \frac{\num[round-precision=#1]{\sumsq}}{\num{\rowcount}}}{\eval{\rowcount - 1}} \approx \frac{\num[round-precision=#1]{\sumofsq} - \evalp{\sumsq / \rowcount}{#1}}{\eval{\rowcount - 1}} \approx \frac{\evalp{\sumofsq - (\sumsq / \rowcount)}{#1}}{\eval{\rowcount - 1}} \\
  &\approx \num[round-precision=#1]{\variance}
}

\newcommand{\eqsd}[1]{
  s &= \sqrt{s^2} \approx \sqrt{\num[round-precision=#1]{\variance}} \approx \evalp{sqrt(\variance)}{#1}
}

\pgfplotstableread{
  180.5
  181.7
  180.9
  181.6
  182.6
  181.6
  181.3
  182.1
  182.1
  180.3
  181.7
  180.5
}{\dataone}

\pgfplotstableread{
  116.4
  115.9
  114.6
  115.2
  115.8
}{\datatwo}

\pgfplotstableread{
  14.8
  14.5
  16.1
  14.2
  15.9
  13.7
  16.2
  14.6
  13.8
  15.0
}{\datathree}

\pgfplotstableread{
  87
  103
  130
  160
  180
  195
  132
  145
  211
  105
  145
  153
  152
  138
  87
  99
  93
  119
  129
}{\datafour}

\begin{document}

\maketitle

\begin{enumerate}
  \item[44.]
    Poly(3-hydroxybutyrate) (PHB), a semicrystalline polymer that is fully biodegradable and biocompatible, is obtained from renewable resources. From a sustainability perspective, PHB offers many attractive properties though it is more expensive to produce than standard plastics. The accompanying data on melting point (\textcelsius) for each of 12 specimens of the polymer using a differential scanning calorimeter appeared in the article ``The Melting Behaviour of Poly(3-Hydroxybutyrate) by DSC. Reproducibility Study'' (\textit{Polymer Testing}, 2013: 215–220).
    \begin{center}
      \begin{tabular}{*{6}{c}}
        180.5 & 181.7 & 180.9 & 181.6 & 182.6 & 181.6 \\
        181.3 & 182.1 & 182.1 & 180.3 & 181.7 & 180.5
      \end{tabular}
    \end{center}
    Compute the following:
    \sd{\dataone}
        hello \rowcount
    \begin{enumerate}
      \item[a.]
        The sample range
        \begin{align*}
          \max(x) - \min(x) = 182.7 - 180.3 = 2.4
        \end{align*}
      \item[b.]
        The sample variance $s^2$ from the definition [\textit{Hint:} First subtract 180 from each observation.]
        \begin{align*}
          \eqmean{2}
        \end{align*}
        \begin{center}
          \pgfplotstabletypeset[
            columns={rownum, 0, deviation, devsq},
            sd={Specimen}{2}{1.2}{2}{1.3}{3},
          ]{\dataone}
        \end{center}
        \calcvariance{\dataone}
        \begin{align*}
          \eqvariance{3}
        \end{align*}
      \item[c.] The sample standard deviation
        \begin{align*}
          \eqsd{3}
        \end{align*}
    \end{enumerate}

  \item[45.]
    The value of Young’s modulus (GPa) was determined for cast plates consisting of certain intermetallic substrates, resulting in the following sample observations (``Strength and Modulus of a Molybdenum-Coated Ti-25Al-10Nb-3U-1Mo Intermetallic,'' \textit{J. of Materials Engr. and Performance}, 1997: 46–50):
    \begin{center}
      \begin{tabular}{*{5}{c}}
        116.4 & 115.9 & 114.6 & 115.2 & 115.8
      \end{tabular}
    \end{center}
    \begin{enumerate}
      \item[a.]
        Calculate $\bar{x}$ and the deviations from the mean.
        \sd{\datatwo}
        \begin{align*}
          \eqmean{2}
        \end{align*}
        \begin{center}
          \pgfplotstabletypeset[
            columns={rownum, 0, deviation},
            sd={Plate}{1}{1.2}{2}{1.3}{3},
          ]{\datatwo}
        \end{center}
      \item[b.]
        Use the deviations calculated in part (a) to obtain the sample variance and the sample standard deviation.
        \begin{center}
          \pgfplotstabletypeset[
            columns={rownum, 0, deviation, devsq},
            sd={Plate}{1}{1.2}{2}{1.3}{3},
          ]{\datatwo}
        \end{center}
        \calcvariance{\datatwo}
        \begin{align*}
          \eqvariance{3} \\
          \eqsd{3}
        \end{align*}
      \item[d.]
        Subtract 100 from each observation to obtain a sample of transformed values. Now calculate the sample variance of these transformed values, and compare it to $s^2$ for the original data.
        \subcol{\datatwo}{0}{100}{\datatwod}
        \sd{\datatwod}
        \begin{align*}
          \eqmean{2}
        \end{align*}
        \begin{center}
          \pgfplotstabletypeset[
            columns={rownum, 0, deviation, devsq},
            sd={Plate}{1}{1.2}{2}{1.3}{3},
          ]{\datatwod}
        \end{center}
        \calcvariance{\datatwod}
        \begin{align*}
          \eqvariance{3}
        \end{align*}
        The sample variance is equivalent to the sample variance of the original data.
    \end{enumerate}
  \item[47.]
    Zinfandel is a popular red wine varietal produced almost exclusively in California. It is rather controversial among wine connoisseurs because its alcohol content varies quite substantially from one producer to another. In May 2013, the author went to the website klwines.com, randomly selected 10 zinfandels from among the 325 available, and obtained the following values of alcohol content (\%):
    \begin{center}
      \begin{tabular}{*{5}{c}}
        14.8 & 14.5 & 16.1 & 14.2 & 15.9 \\
        13.7 & 16.2 & 14.6 & 13.8 & 15.0
      \end{tabular}
    \end{center}
    \sd{\datathree}
    \begin{enumerate}
      \item[a.]
        Calculate and interpret several measures of center.
        \calcmedian{\datathree}
        \begin{align*}
          \eqmean{2} \\
          \eqmedianeven{2}
        \end{align*}
        The mean is greater than the median, indicating a positive skew.
      \item[b.]
        Calculate the sample variance using the defining formula.
        \begin{center}
          \pgfplotstabletypeset[
            columns={rownum, 0, deviation, devsq},
            sd={Zinfandel}{2}{1.2}{2}{1.3}{3},
          ]{\datathree}
        \end{center}
        \calcvariance{\datathree}
        \begin{align*}
          \eqvariance{3}
        \end{align*}
      \item[c.]
        Calculate the sample variance using the shortcut formula after subtracting 13 from each observation.
        \subcol{\datathree}{0}{13}{\datathreec}
        \sd{\datathreec}
        \begin{align*}
          \eqmean{2}
        \end{align*}
        \begin{center}
          \pgfplotstabletypeset[
            columns={rownum, 0},
            sd={Zinfandel}{2}{1.2}{2}{1.3}{3},
          ]{\datathreec}
        \end{center}
        \calcvariancealt{\datathreec}
        \begin{align*}
          \eqvariancealt{3}
        \end{align*}
    \end{enumerate}
  \item[51.]
    The article ``A Thin-Film Oxygen Uptake Test for the Evaluation of Automotive Crankcase Lubricants'' (\textit{Lubric. Engr.}, 1984: 75–83) reported the following data on oxidation-induction time (min) for various commercial oils:
    \begin{center}
      \begin{tabular}{*{11}{S[table-format=3.0]}}
        87 & 103 & 130 & 160 & 180 & 195 & 132 & 145 & 211 & 105 & 145 \\
        153 & 152 & 138 & 87 & 99 & 93 & 119 & 129
      \end{tabular}
    \end{center}
    \sd{\datafour}
    \begin{enumerate}
      \item[a.]
        Calculate the sample variance and standard deviation.
        \begin{align*}
          \eqmean{2}
        \end{align*}
        \begin{center}
          \pgfplotstabletypeset[
            columns={rownum, 0, deviation, devsq},
            sd={Oil}{1}{2.1}{1}{4.1}{2},
          ]{\datafour}
        \end{center}
        \calcvariance{\datafour}
        \begin{align*}
          \eqvariance{2} \\
          \eqsd{2}
        \end{align*}
      \item[b.]
        If the observations were reexpressed in hours, what would be the resulting values of the sample variance and sample standard deviation? Answer without actually performing the reexpression.
        \\ \\
        Multiplying every term in the set by a constant $c$ results in the sample variance being multiplied by $c^2$ and the standard deviation being multiplied by $c$. Let $s$ be the original and $s_h$ the new.
        \begin{align*}
          s_h^2 &= \frac{\sum(cx_i - c\bar{x})^2}{n - 1} = \frac{\sum c^2(x_i - \bar{x})^2}{n - 1} = \frac{c^2 \sum(x_i - \bar{x})^2}{n - 1} = c^2 \frac{\sum(x_i - \bar{x})^2}{n - 1} = c^2s^2 \\
          s_h &= \sqrt{s_h^2} = \sqrt{c^2s^2} = c \cdot s
        \end{align*}
        Therefore, the sample variance would be $(\frac{1}{60})^2 s^2 = \frac{s^2}{3600}$ and the standard deviation would be $\frac{s}{60}$.
    \end{enumerate}
\end{enumerate}

\end{document}
